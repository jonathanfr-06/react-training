"use strict";(self._cf=self._cf||[]).push([[8575],{808575:(e,t,i)=>{i.d(t,{Z:()=>V});var r=i(615919),s=i(199009),n=i(238394),a=i(373244);function o(e,t){return e.filter(((e,i,r)=>r.findIndex((i=>t?t(e,i):e===i))===i))}var l=i(24359),c=i(570413),u=i(475011),d=i(709816),p=i(220515);class h{constructor(e,t,i,r="link-picker",n=!1,a=[]){switch((0,s.Z)(this,"client",void 0),(0,s.Z)(this,"scope",void 0),(0,s.Z)(this,"cloudId",void 0),(0,s.Z)(this,"cloudIds",void 0),(0,s.Z)(this,"analyticsIdentifier",void 0),(0,s.Z)(this,"useConfluenceTypeInAri",void 0),t){case d.s.ConfluencePageBlog:case d.s.ConfluencePageBlogWhiteboard:case d.s.JiraIssue:case d.s.TownsquareProject:break;default:throw new Error(`Unsupported scope - ${t}`)}this.scope=t,this.cloudId=e,this.cloudIds=a,this.analyticsIdentifier=r,this.useConfluenceTypeInAri=n;const o={cloudId:e,aggregatorUrl:i};this.client=(0,p.e)(o)}getAriString(e){try{return new u.ResourceIdentifier(e).toString()}catch(t){return""}}confluencePageBlogResponseTransformer(e){return e?e.results.map((e=>{var t;return{title:e.title,url:e.baseUrl+e.url,container:e.container.title,contentType:this.mapToContentType(e.content&&e.content.type),updatedTimestamp:e.lastModified,objectId:0===this.cloudIds.length?this.getAriString({resourceOwner:"confluence",cloudId:this.cloudId,resourceType:this.useConfluenceTypeInAri&&(null===(t=e.content)||void 0===t?void 0:t.type)||"content",resourceId:e.content&&e.content.id}):e.baseUrl+e.url}})):[]}jiraIssueResponseTransformer(e){return e?e.results.map((e=>({title:e.name,url:e.url,container:e.attributes.container&&e.attributes.container.title||"",contentType:this.mapToContentType(e.attributes["@type"],e.attributes.issueTypeName),updatedTimestamp:e.attributes.updated,objectId:0===this.cloudIds.length?this.getAriString({resourceOwner:"jira",cloudId:this.cloudId,resourceType:"issue",resourceId:e.id}):e.url}))):[]}townsquareProjectResponseTransformer(e){if(!e)return[];return e.results.map((e=>{const{title:t,url:i,iconUrl:r}=e;return{title:t,url:i,iconUrl:r,container:"",contentType:this.mapToContentType("townsquareProject"),objectId:i}}))}mapToContentType(e,t){switch(e){case"issue":switch(t){case"Bug":return"jira.issue.bug";case"Story":return"jira.issue.story";case"Task":return"jira.issue.task";default:return"jira.issue"}case"townsquareProject":return"townsquare.project";case"page":return"confluence.page";case"blogpost":return"confluence.blogpost";case"whiteboard":return"confluence.whiteboard";default:return"default"}}async quickSearch(e,t){const i=await this.client.search({query:e,scopes:[this.scope],analytics:{identifier:this.analyticsIdentifier},resultLimit:t,sites:this.cloudIds});if(this.scope===d.s.ConfluencePageBlog||this.scope===d.s.ConfluencePageBlogWhiteboard){const e=i.response.retrieveScope(this.scope);return this.confluencePageBlogResponseTransformer(e)}if(this.scope===d.s.JiraIssue){const e=i.response.retrieveScope(this.scope);return this.jiraIssueResponseTransformer(e)}if(this.scope===d.s.TownsquareProject){const e=i.response.retrieveScope(this.scope);return this.townsquareProjectResponseTransformer(e)}throw new Error(`Unsupported scope - ${this.scope}`)}}var f=i(840506),C=i(392785),g=i(560170),y=i(555427),m=i(67280),I=i(582751),b=i(320250);const k=()=>f.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},f.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 0C0.895431 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H14C15.1046 16 16 15.1046 16 14V2C16 0.895431 15.1046 0 14 0H2ZM6.76162 3.41159C7.86083 2.11703 9.46511 1.64478 10.6195 2.27467C10.7705 2.35706 10.9977 2.49509 11.1722 2.71987C11.373 2.97851 11.4727 3.31107 11.409 3.68304C11.3524 4.01358 11.1765 4.31922 10.9546 4.60153C10.8863 4.68851 10.8097 4.77814 10.7246 4.87072C11.674 4.60241 12.5151 4.65073 13.1473 5.09225C13.9681 5.6655 14.1134 6.66452 13.9141 7.50611C13.8187 7.90918 13.4146 8.15858 13.0115 8.06316C12.6084 7.96774 12.359 7.56363 12.4545 7.16056C12.5709 6.6688 12.4237 6.41651 12.2884 6.32204C12.1286 6.21042 11.6364 6.05866 10.5554 6.52127C10.3091 6.62667 10.0224 6.63652 9.81961 6.62447C9.59851 6.61132 9.32166 6.56256 9.07282 6.44016C8.84101 6.32614 8.43506 6.03646 8.43173 5.48745C8.42884 5.01198 8.74599 4.65814 9.01233 4.43019C9.3922 4.10508 9.63128 3.85787 9.77522 3.67471C9.8072 3.63401 9.83276 3.59864 9.85315 3.56837C9.50001 3.41882 8.68015 3.4696 7.90504 4.38247C7.63694 4.69821 7.16364 4.73684 6.84789 4.46874C6.53215 4.20064 6.49352 3.72734 6.76162 3.41159ZM4.83333 9.41667C5.56971 9.41667 6.16667 8.81971 6.16667 8.08333C6.16667 7.34695 5.56971 6.75 4.83333 6.75C4.09695 6.75 3.5 7.34695 3.5 8.08333C3.5 8.81971 4.09695 9.41667 4.83333 9.41667ZM4.83333 10.9167C6.39814 10.9167 7.66667 9.64814 7.66667 8.08333C7.66667 6.51853 6.39814 5.25 4.83333 5.25C3.26853 5.25 2 6.51853 2 8.08333C2 9.64814 3.26853 10.9167 4.83333 10.9167ZM9.14834 8.88394C9.53883 8.2494 10.4612 8.2494 10.8517 8.88394L13.0621 12.4759C13.4721 13.1422 12.9928 14 12.2104 14H7.78956C7.00724 14 6.52789 13.1422 6.9379 12.4759L9.14834 8.88394ZM8.68435 12.5L10 10.3621L11.3157 12.5H8.68435Z",fill:"#00A3BF"}));k.displayName="Whiteboard16Icon";const v=k;var w=i(39030),Z=i(93972),S=i(747472),A=i(19456),L=i(166988),T=i(862411);const R=w.iv`
  height: ${120}px;
  margin: 0 auto ${"var(--ds-space-300, 24px)"};
  display: block;
`,E=w.iv`
  mix-blend-mode: multiply;
`,j=()=>{const e="link-picker-ui-empty-state-no-results-svg";return(0,w.tZ)("svg",{css:R,height:"202",viewBox:"0 0 201 202",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,w.tZ)("g",{clipPath:`url(#${e}-a)`},(0,w.tZ)("rect",{width:"200.6",height:"201.4",transform:"translate(0 0.400391)",fill:"white",fillOpacity:"0.01"}),(0,w.tZ)("path",{d:"M126.8 141.901L117.3 132.501L130.4 119.301L139.9 128.701C142.319 131.083 145.375 132.716 148.7 133.401C152.017 134.165 155.061 135.826 157.5 138.201L196.1 176.301C198.905 179.083 200.5 182.859 200.537 186.81C200.575 190.76 199.052 194.566 196.3 197.401C193.505 200.193 189.721 201.769 185.771 201.788C181.82 201.807 178.022 200.266 175.2 197.501L136.6 159.401C134.176 156.984 132.478 153.935 131.7 150.601C130.98 147.273 129.272 144.241 126.8 141.901Z",fill:"#CFD4DB"}),(0,w.tZ)("path",{d:"M126.8 141.901L123.9 139.001C123.032 138.145 122.343 137.126 121.873 136.001C121.403 134.877 121.16 133.67 121.16 132.451C121.16 131.232 121.403 130.026 121.873 128.901C122.343 127.777 123.032 126.757 123.9 125.901C124.749 125.027 125.764 124.33 126.885 123.851C128.005 123.372 129.21 123.121 130.429 123.112C131.648 123.102 132.856 123.335 133.984 123.797C135.112 124.259 136.137 124.94 137 125.801L139.9 128.701C142.319 131.084 145.375 132.716 148.7 133.401C152.017 134.166 155.061 135.826 157.5 138.201L196.1 176.301C198.905 179.083 200.5 182.859 200.537 186.81C200.575 190.761 199.052 194.567 196.3 197.401C193.505 200.193 189.721 201.77 185.771 201.788C181.82 201.807 178.021 200.267 175.2 197.501L136.6 159.401C134.176 156.984 132.478 153.935 131.7 150.601C130.98 147.274 129.272 144.242 126.8 141.901Z",fill:`url(#${e}-b)`}),(0,w.tZ)("g",{css:E},(0,w.tZ)("path",{d:"M131.6 150.301C130.831 147.102 129.166 144.188 126.8 141.901L123.9 139.001C123.032 138.145 122.343 137.126 121.873 136.001C121.403 134.877 121.16 133.67 121.16 132.451C121.16 131.232 121.403 130.026 121.873 128.901C122.343 127.777 123.032 126.757 123.9 125.901C124.749 125.027 125.764 124.33 126.885 123.851C128.005 123.372 129.21 123.121 130.429 123.112C131.648 123.102 132.856 123.335 133.984 123.797C135.112 124.259 136.137 124.94 137 125.801L139.9 128.701C142.201 131.008 145.117 132.605 148.3 133.301C145.957 136.549 143.384 139.623 140.6 142.501C137.789 145.311 134.781 147.918 131.6 150.301Z",fill:"#FFE380"})),(0,w.tZ)("path",{d:"M155.5 77.6001C155.377 62.2312 150.705 47.243 142.073 34.5266C133.441 21.8102 121.236 11.9354 106.998 6.14812C92.7594 0.360847 77.1261 -1.07958 62.0702 2.00857C47.0142 5.09673 33.2102 12.5751 22.3999 23.5001C15.2082 30.7469 9.52542 39.3483 5.68044 48.8062C1.83546 58.2642 -0.095298 68.3909 -5.8712e-05 78.6001C0.0416033 88.8071 2.10435 98.9048 6.06912 108.31C10.0339 117.716 15.8222 126.243 23.0999 133.4C34.0491 144.187 47.948 151.489 63.0429 154.385C78.1378 157.281 93.7522 155.641 107.916 149.671C122.08 143.702 134.158 133.671 142.626 120.844C151.095 108.018 155.575 92.9701 155.5 77.6001Z",fill:"#0065FF"}),(0,w.tZ)("path",{d:"M35.5999 36.5011C42.4408 29.5751 50.8841 24.443 60.1821 21.5593C69.48 18.6756 79.3456 18.1294 88.905 19.9689C98.4645 21.8084 107.423 25.9769 114.987 32.1052C122.55 38.2336 128.486 46.1326 132.268 55.1028C136.05 64.0729 137.562 73.8373 136.669 83.5311C135.776 93.2249 132.507 102.549 127.15 110.678C121.794 118.806 114.515 125.488 105.959 130.132C97.4035 134.776 87.8346 137.238 78.0999 137.301C66.4111 137.329 54.9748 133.902 45.2277 127.45C35.4807 120.999 27.8577 111.81 23.3165 101.04C18.7753 90.2691 17.5185 78.3966 19.704 66.9139C21.8894 55.4312 27.4197 44.8505 35.5999 36.5011Z",fill:"#DEEBFF"}),(0,w.tZ)("path",{d:"M40.2 33.3C34.2324 38.2795 29.3188 44.4 25.7471 51.303C22.1754 58.2059 20.0176 65.7524 19.4 73.5C18.0987 89.132 23.0546 104.641 33.1793 116.622C43.3041 128.603 57.7699 136.076 73.4 137.4C85.0685 138.416 96.7757 135.941 107.035 130.291C117.295 124.64 125.644 116.069 131.023 105.664C136.402 95.2598 138.568 83.4917 137.247 71.8538C135.925 60.216 131.175 49.2333 123.6 40.3C118.59 34.3552 112.456 29.4574 105.549 25.8872C98.6428 22.3169 91.0999 20.1444 83.3525 19.4942C75.6052 18.8439 67.8056 19.7287 60.4008 22.0977C52.9959 24.4668 46.1312 28.2736 40.2 33.3Z",fill:"#B2D4FF"}),(0,w.tZ)("path",{d:"M78.7001 26.7001C70.961 26.045 63.1687 26.9271 55.7718 29.2955C48.3749 31.6639 41.5195 35.4718 35.6001 40.5001C32.1218 43.4231 29.0002 46.746 26.3001 50.4001C21.631 59.038 19.1877 68.7031 19.1909 78.5222C19.1941 88.3412 21.6438 98.0047 26.3185 106.64C30.9932 115.274 37.7457 122.608 45.9659 127.979C54.186 133.35 63.6147 136.588 73.4001 137.4C81.1501 138.105 88.9628 137.256 96.3807 134.903C103.799 132.551 110.673 128.742 116.6 123.7C120.055 120.715 123.173 117.362 125.9 113.7C130.545 105.051 132.965 95.3828 132.944 85.5657C132.923 75.7485 130.461 66.0907 125.78 57.4617C121.098 48.8326 114.344 41.5033 106.126 36.1334C97.9076 30.7636 88.4828 27.5219 78.7001 26.7001Z",fill:"#DEEBFF"}),(0,w.tZ)("path",{d:"M77.7002 115.3L120.9 72.0996H92.1002L77.7002 115.3Z",fill:"#0065FF"}),(0,w.tZ)("path",{d:"M63.4001 72.0996L77.7001 115.3L92.1001 72.0996H63.4001Z",fill:"#2684FF"}),(0,w.tZ)("path",{d:"M34.6001 72.0996L77.7001 115.3L63.4001 72.0996H34.6001Z",fill:"#B2D4FF"}),(0,w.tZ)("path",{d:"M106.5 53.6992L92.1001 72.0992H120.9L106.5 53.6992Z",fill:"#2684FF"}),(0,w.tZ)("path",{d:"M77.7001 53.6992L63.4001 72.0992H92.1001L77.7001 53.6992Z",fill:"#4C9AFF"}),(0,w.tZ)("path",{d:"M63.4 72.0992L77.7 53.6992H49L63.4 72.0992Z",fill:"#B2D4FF"}),(0,w.tZ)("path",{d:"M92.1002 72.0992L106.5 53.6992H77.7002L92.1002 72.0992Z",fill:"#0065FF"}),(0,w.tZ)("path",{d:"M49.0001 53.6992L34.6001 72.0992H63.4001L49.0001 53.6992Z",fill:"white"}),(0,w.tZ)("path",{d:"M49 64C49.5559 61.496 50.8086 59.2003 52.6134 57.3778C54.4182 55.5553 56.7016 54.2803 59.2001 53.7C56.6989 53.1611 54.4063 51.9121 52.5971 50.1029C50.7879 48.2938 49.539 46.0012 49 43.5C48.4384 45.9907 47.182 48.2711 45.3766 50.0766C43.5712 51.882 41.2908 53.1384 38.8 53.7C41.2933 54.2912 43.5709 55.5697 45.3739 57.3904C47.177 59.2112 48.4332 61.5011 49 64Z",fill:"#4C9AFF"}),(0,w.tZ)("path",{d:"M109.5 115.3C109.908 113.493 110.82 111.839 112.13 110.53C113.439 109.22 115.093 108.308 116.9 107.9C115.104 107.47 113.461 106.551 112.155 105.245C110.849 103.939 109.93 102.297 109.5 100.5C109.092 102.307 108.18 103.961 106.871 105.27C105.561 106.58 103.907 107.492 102.1 107.9C103.912 108.297 105.572 109.205 106.884 110.516C108.195 111.828 109.103 113.488 109.5 115.3Z",fill:"white"})),(0,w.tZ)("defs",null,(0,w.tZ)("linearGradient",{id:`${e}-b`,x1:"200.56",y1:"162.451",x2:"121.18",y2:"162.451",gradientUnits:"userSpaceOnUse"},(0,w.tZ)("stop",{stopColor:"#FF991F"}),(0,w.tZ)("stop",{offset:"1",stopColor:"#FFC400"})),(0,w.tZ)("clipPath",{id:`${e}-a`},(0,w.tZ)("rect",{width:"200.6",height:"201.4",fill:"white",transform:"translate(0 0.400391)"}))))};j.displayName="EmptyStateNoResultsSVG";const P=(0,w.iv)({marginBottom:"var(--ds-space-negative-200, -16px)",p:{margin:"0"}}),M=(0,Z.defineMessages)({noResults:{id:"fabric.linkPickerAtlassianPlugin.emptyStateNoResults.heading",defaultMessage:"Get started with {productName}."},noResultsConfluenceDescription:{id:"fabric.linkPickerAtlassianPlugin.emptyStateNoResults.confluenceDescription",defaultMessage:"Recently viewed pages will appear once you <link>start using Confluence</link>."},noResultsJiraDescription:{id:"fabric.linkPickerAtlassianPlugin.emptyStateNoResults.jiraDescription",defaultMessage:"Recently viewed issues will appear once you <link>start using Jira</link>."},noResultsDefaultDescription:{id:"fabric.linkPickerAtlassianPlugin.emptyStateNoResults.defaultDescription",defaultMessage:"Recently viewed items will appear once you <link>start using {productName}</link>."},noResultsConfluenceCreateOption:{id:"fabric.linkPickerAtlassianPlugin.emptyStateNoResults.description",defaultMessage:"You can also create a new page."}}),F="link-picker-empty-state-no-results",N=({product:e,action:t,cloudId:i,isMultisiteSearch:r})=>{const s=(0,S.Z)(),{data:n}=(0,L.G)(),a="confluence"===e,o=B(e);if(!o)return null;const l=n.find(_(o.availableSitesProduct,i,r));if(l){let e=l.url;a&&(e+="/wiki");const i=s.formatMessage(o.description,{productName:o.productName,link:t=>(0,w.tZ)("a",{href:e},t)}),r=a&&t?s.formatMessage(M.noResultsConfluenceCreateOption):"";return(0,w.tZ)("div",{css:P},(0,w.tZ)(A.Z,{testId:F,header:s.formatMessage(M.noResults,{productName:o.productName}),description:(0,w.tZ)("span",null,i," ",r),renderImage:()=>(0,w.tZ)(j,null)}))}return null},B=e=>{switch(e){case"confluence":return{availableSitesProduct:T.j.CONFLUENCE,productName:"Confluence",description:M.noResultsConfluenceDescription};case"jira":return{availableSitesProduct:T.j.JIRA_SOFTWARE,productName:"Jira",description:M.noResultsJiraDescription};case"atlas":return{availableSitesProduct:T.j.ATLAS,productName:"Atlas",description:M.noResultsDefaultDescription};default:return}},_=(e,t,i)=>r=>!!r.products.includes(e)&&(!t||(!!i||r.cloudId===t)),D=(0,Z.defineMessages)({hyperlinkIconIssueLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconIssueLabel",defaultMessage:"Issue"},hyperlinkIconBugLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconBugLabel",defaultMessage:"Bug"},hyperlinkIconStoryLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconStoryLabel",defaultMessage:"Story"},hyperlinkIconTaskLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconTaskLabel",defaultMessage:"Task"},hyperlinkIconPageLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconPageLabel",defaultMessage:"Page"},hyperlinkIconBlogLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconBlogLabel",defaultMessage:"Blog"},hyperlinkIconWhiteboardLabel:{id:"fabric.linkPicker.headingLink.hyperlinkIconWhiteboardLabel",defaultMessage:"Whiteboard"},story:{id:"fabric.linkPicker.story",defaultMessage:"Story"},epic:{id:"fabric.linkPicker.epic",defaultMessage:"Epic"},task:{id:"fabric.linkPicker.task",defaultMessage:"Task"},bug:{id:"fabric.linkPicker.bug",defaultMessage:"Bug"},subTask:{id:"fabric.linkPicker.subTask",defaultMessage:"Sub-task"},improvement:{id:"fabric.linkPicker.improvement",defaultMessage:"Improvement"},defaultAltText:{id:"fabric.linkPicker.defaultAltText",defaultMessage:"List item"}});var O=function(e){return e[e["jira.issue"]=0]="jira.issue",e[e["jira.issue.bug"]=1]="jira.issue.bug",e[e["jira.issue.story"]=2]="jira.issue.story",e[e["jira.issue.task"]=3]="jira.issue.task",e[e["confluence.page"]=4]="confluence.page",e[e["confluence.blogpost"]=5]="confluence.blogpost",e[e["confluence.whiteboard"]=6]="confluence.whiteboard",e}(O||{});const U=(e,t,i,r)=>f.createElement(N,{product:e,action:t,cloudId:i,isMultisiteSearch:r});U.displayName="renderEmptyStateNoResults";const x={"jira.issue":{icon:({alt:e})=>f.createElement(y.default,{label:e}),iconAlt:D.hyperlinkIconIssueLabel},"jira.issue.bug":{icon:({alt:e})=>f.createElement(g.default,{label:e}),iconAlt:D.hyperlinkIconBugLabel},"jira.issue.story":{icon:({alt:e})=>f.createElement(I.default,{label:e}),iconAlt:D.hyperlinkIconStoryLabel},"jira.issue.task":{icon:({alt:e})=>f.createElement(b.default,{label:e}),iconAlt:D.hyperlinkIconTaskLabel},"confluence.page":{icon:({alt:e})=>f.createElement(m.Z,{label:e}),iconAlt:D.hyperlinkIconPageLabel},"confluence.blogpost":{icon:({alt:e})=>f.createElement(C.Z,{label:e}),iconAlt:D.hyperlinkIconBlogLabel},"confluence.whiteboard":{icon:()=>f.createElement(v,null),iconAlt:D.hyperlinkIconWhiteboardLabel}},q=e=>(e=>Boolean(e&&Object.keys(O).includes(e)))(e)?x[e]:{icon:({alt:e})=>f.createElement(m.Z,{label:e}),iconAlt:D.defaultAltText},J=e=>{let t=D.defaultAltText;return e.includes("story.svg")&&(t=D.story),e.includes("epic.svg")&&(t=D.epic),e.includes("avatarId=10318")&&(t=D.task),e.includes("avatarId=10303")&&(t=D.bug),e.includes("avatarId=10518")&&(t=D.subTask),e.includes("avatarId=10310")&&(t=D.improvement),t};const H=({object:e,containers:t,timestamp:i})=>{var s,n;let a=(null===(s=e.icon)||void 0===s?void 0:s.value)||"";return"EMOJI"===(null===(n=e.icon)||void 0===n?void 0:n.type)&&(a=e.icon.fallback||""),(0,r.Z)((0,r.Z)({objectId:e.id,name:e.name||"",container:$(t),url:e.url},(e=>({icon:e,iconAlt:J(e)}))(a)),{},{lastViewedDate:i?new Date(i):void 0,prefetch:!0,meta:{source:"recent-work"}})},W=({objectId:e,container:t,title:i,contentType:s,url:n,updatedTimestamp:a,iconUrl:o})=>(0,r.Z)((0,r.Z)({objectId:e,name:i,container:t,url:n},o?{icon:o,iconAlt:D.defaultAltText}:q(s)),{},{lastUpdatedDate:a?new Date(a):void 0,prefetch:!1,meta:{source:"xp-search"}}),$=e=>{for(let t=e.length-1;t>=0;--t){const i=e[t].name;if(i)return i}return""};function G(e,t){if(void 0===e)return[`ari:cloud:platform::site/${t}`];const i=e.map((e=>function(e,t){return"townsquare"===e?`ari:cloud:townsquare::site/${t}`:`ari:cloud:platform::site/${t}`}(e,t)));return i.filter(((e,t)=>i.indexOf(e)===t))}const V=class{constructor(e){var t,i;(0,s.Z)(this,"_tabKey",void 0),(0,s.Z)(this,"_tabTitle",void 0),(0,s.Z)(this,"products",void 0),(0,s.Z)(this,"debouncedSearch",void 0),(0,s.Z)(this,"searchProvider",void 0),(0,s.Z)(this,"activityClient",void 0),(0,s.Z)(this,"recentItems",void 0),(0,s.Z)(this,"analyticsIdentifier","link-picker-quick-search"),(0,s.Z)(this,"useConfluenceTypeInAri",!0),(0,s.Z)(this,"cloudId",void 0),(0,s.Z)(this,"cloudIds",void 0),(0,s.Z)(this,"isMultisiteSearch",void 0),(0,s.Z)(this,"_action",void 0);const{tabConfig:r,activityClientEndpoint:n,disableActivityClient:a=!1,searchProvider:o,cloudId:l,cloudIds:u,scope:d,products:p,aggregatorUrl:h,action:f}=null!=e?e:{},{tabKey:C,tabTitle:g}=null!=r?r:{};this._tabKey=C||"Atlassian",this._tabTitle=g||"Atlassian",this.products=p,this.cloudId=l,this.cloudIds=u,this.isMultisiteSearch=(null!==(t=null===(i=this.cloudIds)||void 0===i?void 0:i.length)&&void 0!==t?t:0)>0,this._action=f,this.searchProvider=o||this.createSearchProvider(d,h,this.analyticsIdentifier,this.useConfluenceTypeInAri),a||(this.activityClient=(0,c.r)("v3","link_picker_atlassian_plugin",void 0,n)),this.debouncedSearch=function(e,t){let i;return(...r)=>(i&&clearTimeout(i),new Promise(((s,n)=>{i=setTimeout((()=>{e(...r).then(s).catch(n)}),t)})))}((async e=>{if(!this.searchProvider)return[];return(await this.searchProvider).quickSearch(e,5)}),400)}createSearchProvider(e,t,i,r){if(this.cloudId&&e)return Promise.resolve(new h(this.cloudId,e,t,i,r,this.cloudIds))}filterListItemFields(e){const t=this.products;if(1!==(null==t?void 0:t.length))return e;const i={townsquare:["lastViewedDate","lastUpdatedDate","container"]};return e.map((e=>{const s=(0,r.Z)({},e);for(const[r,n]of Object.entries(i))if(t[0]===r)for(const e of n)s[e]=void 0;return s}))}async getRecentItems(){if(!this.activityClient)return[];if(!this.recentItems){const{viewed:e}=await this.activityClient.fetchActivities([50,125,250],{limit:100,products:this.products,rootContainerIds:void 0===this.cloudId||this.isMultisiteSearch?void 0:G(this.products,this.cloudId)},["viewed"],!0);this.recentItems=e.map(H),this.recentItems=this.filterListItemFields(this.recentItems)}return this.recentItems}async searchRecentItems({query:e}){return this.recentItems||await this.getRecentItems(),t=this.recentItems,(i=e)&&t?t.filter((e=>e.name.toLowerCase().indexOf(i.toLowerCase())>-1)):[];var t,i}async quickSearch(e){const t=await this.debouncedSearch(e.query);return this.filterListItemFields(t.map(W))}mergeResults(e,t){return(0,l.e)("platform.linking-platform.link-picker.fix-duplicate-results")?o([...e,...t],((e,t)=>e.url===t.url)):o([...e,...t],((e,t)=>this.isMultisiteSearch?e.url===t.url:e.objectId===t.objectId))}resolve(e){var t=this;return(0,a.Z)((function*(){if(t.activityClient&&0===e.query.length)return{data:yield(0,n.Z)(t.getRecentItems())};const i=yield(0,n.Z)(t.searchRecentItems(e));if(i.length>=5||!t.searchProvider)return{data:i};i.length&&(yield{data:i});const r=yield(0,n.Z)(t.quickSearch(e));return{data:t.mergeResults(i,r)}}))()}emptyStateNoResults(){return this.activityClient&&this.products&&1===this.products.length?U(this.products[0],this.action,this.cloudId,this.isMultisiteSearch):null}get tabKey(){return this._tabKey}get tabTitle(){return this._tabTitle}get action(){return this._action}}},166988:(e,t,i)=>{i.d(t,{G:()=>p,y:()=>h});var r=i(840506),s=i(862411);const n=function(e,t){const i=e.split(".");return{eventType:i[0],actionSubject:i[1],action:i[2],actionSubjectId:i[3],attributes:t}};var a=i(486889);var o=i(615919),l=i(528215);const c=e=>{try{return new URL(e).pathname}catch(t){return"Failed to parse pathname from url"}},u=e=>{if(e instanceof Response)return(0,o.Z)({error:"NetworkError",errorType:"NetworkError"},(e=>e instanceof Response?{traceId:(0,l.W)(e),status:e.status,path:c(e.url)}:{traceId:null,status:null,path:null})(e));const t=e instanceof Error?e:new Error("unknown error");return{error:t.name,errorType:t.name,traceId:null,status:null,path:null}},d=[s.j.WHITEBOARD,s.j.BEACON,s.j.COMPASS,s.j.CONFLUENCE,s.j.JIRA_BUSINESS,s.j.JIRA_INCIDENT_MANAGER,s.j.JIRA_PRODUCT_DISCOVERY,s.j.JIRA_SERVICE_DESK,s.j.JIRA_SOFTWARE,s.j.MERCURY,s.j.OPSGENIE,s.j.STATUS_PAGE,s.j.ATLAS],p=({gatewayBaseUrl:e}={})=>{const[t,i]=(0,r.useState)({data:[],loading:!0}),{createAnalyticsEvent:s}=(0,a._)();return(0,r.useEffect)((()=>{(async()=>{try{const{sites:t}=await f({products:d,gatewayBaseUrl:e});i({data:t,loading:!1,error:void 0})}catch(t){s(n("operational.getAvailableSitesResolve.failed",u(t))).fire("media");const e=t instanceof Error?t:new Error("unknown error");i({data:[],loading:!1,error:e})}})()}),[s,e]),t},h=({gatewayBaseUrl:e})=>{const{createAnalyticsEvent:t}=(0,a._)(),i=function(){const e=(0,r.useRef)(!1);return(0,r.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,r.useCallback)((()=>e.current),[])}(),[s,n]=(0,r.useState)({data:[],loading:!0});return(0,r.useEffect)((()=>{(async()=>{try{const{sites:t}=await f({products:d,gatewayBaseUrl:e});i()&&n({data:t,loading:!1,error:void 0})}catch(t){i()&&n({data:[],loading:!1,error:t})}})()}),[t,e,i]),s};async function f({products:e,gatewayBaseUrl:t}){const i={method:"POST",credentials:"include",headers:{Accept:"application/json","Cache-Control":"no-cache","Content-Type":"application/json"},body:JSON.stringify({products:e})},r=await window.fetch(t?`${t}/gateway/api/available-sites`:"/gateway/api/available-sites",i);if(r.ok)return r.json();throw r}},862411:(e,t,i)=>{i.d(t,{j:()=>r});let r=function(e){return e.WHITEBOARD="atlassian-whiteboard",e.BEACON="beacon",e.COMPASS="compass",e.CONFLUENCE="confluence.ondemand",e.JIRA_BUSINESS="jira-core.ondemand",e.JIRA_INCIDENT_MANAGER="jira-incident-manager.ondemand",e.JIRA_PRODUCT_DISCOVERY="jira-product-discovery",e.JIRA_SERVICE_DESK="jira-servicedesk.ondemand",e.JIRA_SOFTWARE="jira-software.ondemand",e.MERCURY="mercury",e.OPSGENIE="opsgenie",e.STATUS_PAGE="statuspage",e.ATLAS="townsquare",e}({})},528215:(e,t,i)=>{function r(e){try{var t,i;return null!==(t=null!==(i=e.headers.get("x-trace-id"))&&void 0!==i?i:e.headers.get("atl-traceid"))&&void 0!==t?t:null}catch(r){return null}}i.d(t,{W:()=>r})}}]);
//# sourceMappingURL=8575.Xb80BEiSdZ.js.map