(self._cf=self._cf||[]).push([[46659],{335097:(e,t,n)=>{var i=n(35371);e.exports=function(e){return e&&e.length?i(e):[]}},707146:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});var i=n(840506);const r=(e,t)=>{const n=(0,i.useCallback)((()=>{window.setTimeout((()=>{document.activeElement instanceof HTMLIFrameElement&&t(!1)}),0)}),[t]);(0,i.useEffect)((()=>(e&&window.addEventListener("blur",n),()=>{window.removeEventListener("blur",n)})),[n,e])}},865072:(e,t,n)=>{"use strict";n.d(t,{F:()=>l});var i=n(615919),r=n(199009),o=n(822464),s=n(132464),a=n(400318);class l extends o.W2{constructor(...e){super(...e),(0,r.Z)(this,"state",{items:[],itemsLoaded:!1}),(0,r.Z)(this,"loadTimeout",null),(0,r.Z)(this,"addItem",(e=>{if(this.state.items.filter((t=>t.key===e)).length)return!1;const t={key:e,loaded:!1};return this.state.items.push(t),!0})),(0,r.Z)(this,"getItem",(e=>{const t=this.state.items.find((t=>t.key===e));return t?(0,i.Z)({},t):void 0})),(0,r.Z)(this,"markItem",(async e=>{var t;null!==(t=this.getItem(e))&&void 0!==t&&t.loaded||this.setState((t=>({items:t.items.map((t=>t.key!==e?t:{key:t.key,loaded:!0}))})),this.checkAllItems)})),(0,r.Z)(this,"checkAllItems",(()=>{let e=!0;this.state.items.length&&(this.state.items.forEach((t=>{t.loaded||(e=!1)})),e&&((0,s.OV)().succeed({name:a.eYX}),this.state.itemsLoaded||(this.setState((()=>({itemsLoaded:!0}))),clearTimeout(this.loadTimeout))))})),(0,r.Z)(this,"initItems",(()=>{this.state.items=[],this.state.itemsLoaded=!1,clearTimeout(this.loadTimeout),this.startTimer(),(0,s.OV)().start({name:a.eYX})})),(0,r.Z)(this,"startTimer",(()=>{this.loadTimeout=setTimeout((()=>{(0,s.OV)().fail({name:a.eYX,error:new Error("Grouped Page Buttons loading exceeded 5000 milliseconds")}),this.setState((()=>({itemsLoaded:!0})))}),5e3)}))}}},719323:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});let i=function(e){return e.ENROLLED="enrolled",e.NOT_ENROLLED="not-enrolled",e.CONTROL="control",e.EXPERIMENT="experiment",e.EXPERIMENT_VARIATION_1="experiment-1",e.EXPERIMENT_VARIATION_2="experiment-2",e}({})},92560:(e,t,n)=>{"use strict";n.d(t,{df:()=>l,nJ:()=>a,w4:()=>c});var i=n(654927),r=n.n(i),o=n(719323),s=n(908990);function a({featureFlagClient:e,flagName:t,isUserLocaleCorrect:n,shouldTrackExposureEvent:i=!0,isStatSig:s=!1,exposureData:a}){const l=o.H.NOT_ENROLLED,c=n&&i,d=s?function(e,t,n){try{return r().getExperimentValue(e,"cohort",t,{fireExperimentExposure:n})}catch(i){return t}}(t,l,c):e.getVariantValue(t,{default:l,oneOf:Object.values(o.H),shouldTrackExposureEvent:c,exposureData:a});return d===o.H.EXPERIMENT&&n?n:d===o.H.ENROLLED}const l=(e,t,n,i=!0,r)=>a({featureFlagClient:e,flagName:t,isUserLocaleCorrect:(0,s.RV)(n),shouldTrackExposureEvent:i,exposureData:r}),c=(e,t,n=!0,i)=>a({featureFlagClient:e,flagName:t,isUserLocaleCorrect:!0,shouldTrackExposureEvent:n,exposureData:i})},908990:(e,t,n)=>{"use strict";n.d(t,{IP:()=>r,RV:()=>i,iJ:()=>o});const i=e=>{let t=!0,n=!0;return e&&(t=-1!==e.toLowerCase().indexOf("en",0)),"undefined"!=typeof window&&navigator&&(n=navigator.language.includes("en")),n&&t};let r=function(e){return e.ADD="ADD",e.SUBTRACT="SUBTRACT",e}({});const o=(e,t,n)=>{const i=new Date(e),r=i;let o=i.getMonth();const s=i.getDate();return"ADD"===t?o+=n:"SUBTRACT"===t&&(o-=n),r.setMonth(o),s!=r.getDate()&&r.setDate(0),r}},262600:(e,t,n)=>{"use strict";n.d(t,{j:()=>o});var i=n(199009),r=n(822464);class o extends r.W2{constructor(...e){super(...e),(0,i.Z)(this,"state",{isOpen:!1,triggeredFrom:null,hideRestrictionsButtonSpinner:!1}),(0,i.Z)(this,"initState",(()=>{this.setState({isOpen:!1,triggeredFrom:null,hideRestrictionsButtonSpinner:!1})})),(0,i.Z)(this,"setHideRestrictionsButtonSpinner",(()=>{this.setState({hideRestrictionsButtonSpinner:!0})}))}getIsOpen(){return this.state.isOpen}getTriggeredFrom(){return this.state.triggeredFrom}getHideRestrictionsButtonSpinner(){return this.state.hideRestrictionsButtonSpinner}setIsOpen(e,t=null,n){this.setState({isOpen:e,triggeredFrom:t},(()=>{n&&setTimeout(n,0)}))}}},452077:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var i=n(840506);function r(){return i.createElement("div",{"data-testid":"restrictions-button-placeholder",style:{width:32,height:32}})}r.displayName="RestrictionsButtonPlaceholder"},669178:(e,t,n)=>{"use strict";n.d(t,{G:()=>$,L:()=>G});var i=n(615919),r=n(946972),o=n(840506),s=n(822464),a=n(486889),l=n(190206),c=n(400318),d=n(190713),u=n(115613),m=n(940155);const g=(0,m.ui)({__loadable_id__:"vwNQf",name:"ChangeEditionInlineDialogLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(54936),n.e(11216),n.e(61769),n.e(57941),n.e(30327),n.e(69947),n.e(25831),n.e(12466)]).then(n.bind(n,736703))).ChangeEditionInlineDialog}),p=(0,m.tM)({__loadable_id__:"RkDAV",name:"ChangeEditionInlineDialogPaintLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(54936),n.e(11216),n.e(61769),n.e(57941),n.e(30327),n.e(69947),n.e(25831),n.e(12466)]).then(n.bind(n,736703))).ChangeEditionInlineDialog});var h=n(856389),E=n(872342),S=n(167347),R=n(627521);const _=n(779076).ZP`query GrantAccessDialogLoaderQuery($contentId:ID!$accountId:ID!){content(id:$contentId){nodes{id title}}user(id:$accountId){id displayName photos{value isPrimary}}}`,v=["contentId","accountId","shouldSSRGrantAccessRestrictions","buttonPlaceholder"],T=(0,m.tM)({__loadable_id__:"ywFLn",name:"GrantAccessDialogPaint",loader:async()=>(await Promise.all([n.e(12705),n.e(11216),n.e(33963),n.e(90077),n.e(16215),n.e(82995),n.e(17262)]).then(n.bind(n,167421))).GrantAccessDialog}),f=e=>{var t,r,s;let{contentId:a,accountId:l,shouldSSRGrantAccessRestrictions:c,buttonPlaceholder:d}=e,u=(0,E.Z)(e,v);const g=(0,m.ui)({__loadable_id__:"YnWks",name:"GrantAccessDialog",loader:async()=>(await Promise.all([n.e(12705),n.e(11216),n.e(33963),n.e(90077),n.e(16215),n.e(82995),n.e(17262)]).then(n.bind(n,167421))).GrantAccessDialog,loading:()=>d}),p=c&&window.__SSR_RENDERED__,{data:h,error:f}=(0,S.aM)(_,{variables:{contentId:a||"",accountId:l},skip:!a||!l,fetchPolicy:p?"cache-first":"cache-and-network"});let D="";const I=null==h||null===(t=h.user)||void 0===t?void 0:t.photos;if(null!=I&&I.length){var C;const e=I.find((e=>null==e?void 0:e.isPrimary));D=(e?e.value:null===(C=I[0])||void 0===C?void 0:C.value)||""}const w=c?T:g;return f?o.createElement(R.X,{error:f}):a&&null!=h&&h.user?o.createElement(w,(0,i.Z)({contentId:a,accountId:l,contentTitle:(null==h||null===(r=h.content)||void 0===r||null===(r=r.nodes)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.title)||"",displayName:(null==h||null===(s=h.user)||void 0===s?void 0:s.displayName)||"",profilePhoto:D},u)):o.createElement(o.Fragment,null,u.children)};f.displayName="GrantAccessDialogLoader";var D=n(357261),I=n(734233),C=n(294537),w=n(95221),A=n(582463),y=n(487696),b=n(707146),L=n(262600),k=n(722782),B=n(452077),F=n(861791);const O=()=>{return Boolean(null===(e=window.__SSR_EVENTS_CAPTURE__)||void 0===e?void 0:e.restrictionsButton)?o.createElement(F.C,{spinnerId:"restrictions-loading-spinner",actionType:"restrictionsButton"}):o.createElement(B.D,null);var e},P=(0,m.tM)({__loadable_id__:"odA6O",name:"RestrictionsButtonLoaderPaint",loader:async()=>(await Promise.all([n.e(12705),n.e(61769),n.e(28648)]).then(n.bind(n,865274))).RestrictionsButton,loading:O}),N=(0,m.ZR)({__loadable_id__:"0RRmK",name:"RestrictionsButtonLoaderAfterPaint",loader:async()=>(await Promise.all([n.e(12705),n.e(61769),n.e(28648)]).then(n.bind(n,865274))).RestrictionsButton,loading:B.D});var x=n(929766),Z=n(365091),V=n(423128),U=n(930936);const H=(0,r.Z)("div",{target:"eywtb1e0"})({name:"1hp6i1l",styles:"display:inline-block;vertical-align:top;"}),M="bottom-end",$=(0,o.memo)((e=>{const t=(0,C.k)(e.contentId),{edition:n}=(0,A.D)(),[r,c]=(0,o.useState)({grantAccessClicked:!1,hasAutoOpenedRestrictionDialog:!1,showFreeRestrictionDialog:!1}),d=e.contentSubType,m=(0,a._)(),{contentType:E}=(0,o.useContext)(y.z1),S=(0,o.useContext)(l.F),R=((e=!1)=>{const{edition:t}=(0,A.D)(),n=h.m.FREE===t,{isSiteAdmin:i}=(0,o.useContext)(V.wu),{reverseTrialCohort:r,loading:s,error:a}=(0,x.$)({skip:!n||!i||Boolean(!1)}),l=r===Z.F.VARIANT||r===Z.F.CONTROL;if(n&&i&&!Boolean(!1)&&!s&&!a&&r&&!l)return(0,U.n)(e)})(!1),_=e=>()=>G((0,i.Z)((0,i.Z)({},m),{},{actionSubjectId:"restrictionsDialogButton",dialogStateContainer:e,edition:n,experienceTracker:S,contentType:E,contentSubType:d})),v=()=>{var e,t;(c((e=>(0,i.Z)((0,i.Z)({},e),{},{grantAccessClicked:!0}))),null!==(e=window)&&void 0!==e&&null!==(e=e.__SSR_EVENTS_CAPTURE__)&&void 0!==e&&e.restrictionsButton)&&(null===(t=window.__SSR_EVENTS_CAPTURE__)||void 0===t||delete t.restrictionsButton)},T=()=>{var e,t;(c((e=>(0,i.Z)((0,i.Z)({},e),{},{showFreeRestrictionDialog:!0}))),null!==(e=window)&&void 0!==e&&null!==(e=e.__SSR_EVENTS_CAPTURE__)&&void 0!==e&&e.restrictionsButton)&&(null===(t=window.__SSR_EVENTS_CAPTURE__)||void 0===t||delete t.restrictionsButton)},F=()=>{var e,t;(c((e=>(0,i.Z)((0,i.Z)({},e),{},{showFreeRestrictionDialog:!1}))),null!==(e=window)&&void 0!==e&&null!==(e=e.__SSR_EVENTS_CAPTURE__)&&void 0!==e&&e.restrictionsButton)&&(null===(t=window.__SSR_EVENTS_CAPTURE__)||void 0===t||delete t.restrictionsButton)};(0,b.$)(r.showFreeRestrictionDialog,F);return o.createElement(s.xs,{to:[L.j]},(s=>o.createElement(H,null,o.createElement(u.q,{isCustomStart:!0,key:`start-${t}`,metric:k.j$}),n?o.createElement(I.M.Consumer,null,(({getQueryParams:a})=>{const{accountId:l,grantAccess:d,username:u}=a(),m=Boolean(d&&l||u);return n===h.m.FREE?((n,s)=>{const{isDisabled:a,triggeredFrom:l}=e,d="fromView"===l;return o.createElement(w.Jv,null,(({loading:e,error:u,restrictions:m})=>{if(!m&&e||u)return o.createElement(B.D,null);const h=Boolean((null==m?void 0:m.hasRestrictions)||(null==m?void 0:m.hasInheritedRestrictions)),E=Boolean((null==m?void 0:m.hasInheritedRestrictions)&&!(null!=m&&m.hasRestrictions)),S=((null==m?void 0:m.ancestors.length)||0)-1>0;if(h){if(S&&E){const e=(e=>{const t=(null==e?void 0:e.ancestors)||[];for(let n=t.length-1;n>=0;n--)if(t[n].hasRestrictions)return t[n]})(m);return d?o.createElement(p,{isOpen:r.showFreeRestrictionDialog,onClose:F,parentData:e,isChildPage:S,placement:M},o.createElement(P,{contentId:t,isDisabled:a,shouldHideSpinner:r.showFreeRestrictionDialog,onClick:T,restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free inherited",triggeredFrom:l})):o.createElement(g,{isOpen:r.showFreeRestrictionDialog,onClose:F,parentData:e,isChildPage:S,placement:M},o.createElement(N,{contentId:t,isDisabled:a,shouldHideSpinner:!0,onClick:T,restrictionsButtonSSRLocation:"free inherited",triggeredFrom:l}))}return s&&!r.hasAutoOpenedRestrictionDialog&&(_(n)(),c((e=>(0,i.Z)((0,i.Z)({},e),{},{hasAutoOpenedRestrictionDialog:!0})))),d?o.createElement(P,{contentId:t,isDisabled:a,shouldHideSpinner:n.getHideRestrictionsButtonSpinner(),resetDialogState:()=>n.initState(),onClick:_(n),restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free grandfather",triggeredFrom:l}):o.createElement(N,{contentId:t,isDisabled:a,shouldHideSpinner:!0,onClick:_(n),restrictionsButtonSSRLocation:"free grandfather",triggeredFrom:l})}return d?o.createElement(p,{isOpen:r.showFreeRestrictionDialog,onClose:F,placement:M,pageRestrictionsExperimentCohort:R},o.createElement(P,{contentId:t,shouldHideSpinner:r.showFreeRestrictionDialog,isDisabled:a,onClick:T,restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free",triggeredFrom:l,pageRestrictionsExperimentCohort:R})):o.createElement(g,{isOpen:r.showFreeRestrictionDialog,onClose:F,placement:M,pageRestrictionsExperimentCohort:R},o.createElement(N,{contentId:t,shouldHideSpinner:!0,isDisabled:a,onClick:T,restrictionsButtonSSRLocation:"free",triggeredFrom:l,pageRestrictionsExperimentCohort:R}))}))})(s,m):((n,i,s)=>{const{markItemAsLoaded:a,isDisabled:l,triggeredFrom:c}=e,d=n(),u="fromView"===c;if(s&&!r.grantAccessClicked){const e=(0,D.r)(d,"accountId"),n=(0,D.r)(d,"username")||"";return o.createElement(f,{isOpen:!0,contentId:t,onActionClick:v,accessType:"edit"===(0,D.r)(d,"accessType")?"edit":"view",accountId:e||n,shouldSSRGrantAccessRestrictions:u,buttonPlaceholder:o.createElement(B.D,null)},u?o.createElement(P,{contentId:t,isDisabled:l,shouldHideSpinner:i.getHideRestrictionsButtonSpinner(),resetDialogState:()=>i.initState(),onClick:_(i),markItemAsLoaded:a,restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"default grant access",triggeredFrom:c,pageRestrictionsExperimentCohort:R}):o.createElement(N,{contentId:t,isDisabled:l,shouldHideSpinner:!0,onClick:_(i),markItemAsLoaded:a,restrictionsButtonSSRLocation:"default grant access",triggeredFrom:c,pageRestrictionsExperimentCohort:R}))}return c&&"fromView"===c?o.createElement(P,{contentId:t,isDisabled:l,shouldHideSpinner:i.getHideRestrictionsButtonSpinner(),onClick:_(i),markItemAsLoaded:a,resetDialogState:()=>i.initState(),restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"default",triggeredFrom:c,pageRestrictionsExperimentCohort:R}):o.createElement(N,{contentId:t,isDisabled:l,shouldHideSpinner:!0,onClick:_(i),markItemAsLoaded:a,restrictionsButtonSSRLocation:"default",triggeredFrom:c,pageRestrictionsExperimentCohort:R})})(a,s,m)})):o.createElement(O,null))))}));function G({actionSubjectId:e,createAnalyticsEvent:t,dialogStateContainer:n,edition:i,experienceTracker:r,triggeredFrom:o,contentType:s,contentSubType:a}){r.start({name:c.IP6,attributes:{contentType:s},collect(e,t){t.stopOn(e.find((({action:e,name:t})=>!("taskFail"!==e&&"taskAbort"!==e||t!==c.$sg&&t!==c.fbA))))}}),r.start({name:c.$sg,timeout:d.O.DEFAULT}),n.setIsOpen(!0,o),t({type:"sendUIEvent",data:{source:"viewPageScreen",action:"clicked",actionSubject:"button",actionSubjectId:e,attributes:{source:"v2",triggeredFrom:o,edition:i,contentType:s,subType:a}}}).fire(),k.wz.start()}$.displayName="RestrictionsDialogTrigger"},930936:(e,t,n)=>{"use strict";n.d(t,{n:()=>o});var i=n(654927),r=n.n(i);const o=(e=!1)=>r().getExperiment("cc_page_restrictions_upsell_design",{fireExperimentExposure:e}).get("cohort","none",(e=>"none"===e||"test"===e||"control"===e))},861791:(e,t,n)=>{"use strict";n.d(t,{C:()=>c});var i=n(615919),r=n(946972),o=n(840506),s=n(618305),a=n(474168);const l=(0,r.Z)("div",{target:"e1ghqyl70"})("display:",(({showSpinner:e})=>e?"flex":"none"),";font-size:14px;width:32px;height:32px;justify-content:center;align-items:center;",(({styleOverride:e})=>null!=e?e:""),""),c=({actionType:e,spinnerId:t,showSpinner:n,spinnerSize:r="small",spinnerAppearance:c,style:d})=>{const u=Boolean(window.__SSR_EVENTS_CAPTURE__&&window.__SSR_EVENTS_CAPTURE__[`${e}`]||n),m=o.useRef(Date.now()%860);return o.createElement(l,{"data-id":t,showSpinner:u,"data-testid":t,styleOverride:d},o.createElement(a.ZP,null,(e=>o.createElement(s.Z,(0,i.Z)((0,i.Z)({size:r,delay:-m.current,appearance:c},e),{},{testId:`${t}-spinner`})))))};c.displayName="SSRActionLoadingSpinner"},365091:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});let i=function(e){return e.CONTROL="CONTROL",e.NOT_ENROLLED="NOT_ENROLLED",e.VARIANT="VARIANT",e}({})},929766:(e,t,n)=>{"use strict";n.d(t,{$:()=>p,D:()=>g});var i=n(840506),r=n(167347),o=n(486889),s=n(92560);var a=n(582463),l=n(179640),c=n(423128),d=n(856389);const u=n(779076).ZP`query SignUpProperties{signUpProperties{reverseTrial}}`;var m=n(365091);const g=(e=!1)=>{const{createAnalyticsEvent:t}=(0,o._)(),{featureFlagClient:n,edition:r}=(0,a.D)(),u=r===d.m.PREMIUM,{isSiteAdmin:g}=(0,i.useContext)(c.wu),{reverseTrialCohort:h,loading:E,error:S}=p({skip:!g||!u}),R=(0,l.T)("confluence.frontend.onboarding.experience"),_=g&&u&&R&&((e,t)=>(0,s.w4)(e,"confluence.frontend.onboarding.reverse-trial",t))(n,e),v=!E&&!S&&h===m.F.VARIANT;return(0,i.useEffect)((()=>{!S&&!E&&g&&e&&t({type:"sendTrackEvent",data:{source:"onboardingReverseTrial",action:"exposed",actionSubject:"feature",attributes:{type:"signUpProperties",servedValue:h}}}).fire()}),[t,E,S,g,h,e]),{isReverseTrialEligible:_&&v}};function p({skip:e}={}){var t;const{data:n,loading:i,error:o}=(0,r.aM)(u,{skip:e});return{reverseTrialCohort:null==n||null===(t=n.signUpProperties)||void 0===t?void 0:t.reverseTrial,loading:!e&&i,error:e?null:o}}}}]);
//# sourceMappingURL=46659.vwE5VrAE3Z.js.map