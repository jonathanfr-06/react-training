"use strict";(self._cf=self._cf||[]).push([[64591],{259451:(e,t,n)=>{n.r(t),n.d(t,{ReadTime:()=>k,ReadTimeLoader:()=>_,calculateEstimatedReadTime:()=>$});var a=n(840506),r=n(167347),o=n(486889),l=n(627521),c=n(634554),i=n(206950),u=n(115613),d=n(649233),s=n(615919),m=n(946972),f=n(93972),p=n(142807),g=n(16728),y=n(332072),v=n(870797),b=n(697674),E=n(113059);const h=(0,b.is)({key:E.km}),C=(0,f.defineMessages)({readTime:{id:"read-time.by-line.estimated-read-time",defaultMessage:"{readTime} min read"},tooltipDescription:{id:"read-time.tooltip-description",defaultMessage:"Estimated read time"}}),T=(0,m.Z)("span",{target:"evl2q7h0"})("margin-right:var(--ds-space-050, 4px);padding-left:var(--ds-space-075, 6px);color:",`var(--ds-text-subtle, ${g.Mx})`,';&:before{content:"â€¢";display:inline-block;color:',`var(--ds-text-subtle, ${g.Mx})`,";padding-right:var(--ds-space-100, 8px);text-decoration:none;}");function Z({pageId:e,readTime:t}){const{createAnalyticsEvent:n}=(0,o._)(),r=(0,a.useCallback)((()=>{n({type:"sendUIEvent",data:{source:"page",action:"displayed",actionSubject:"tooltip",actionSubjectId:"estimatedReadTime"}}).fire()}),[n]);return(0,a.useEffect)((()=>{t&&n({type:"sendTrackEvent",data:{source:"confluence-frontend",action:"displayed",actionSubject:"readTime",actionSubjectId:e,attributes:{readTime:t}}}).fire()}),[e,t,n]),a.createElement(a.Fragment,null,a.createElement(T,null,a.createElement(y.Z,{tag:"span",content:a.createElement(p.Z,(0,s.Z)({},C.tooltipDescription)),onShow:r},a.createElement(p.Z,(0,s.Z)((0,s.Z)({},C.readTime),{},{values:{readTime:t}})))),a.createElement(v.M,{metric:h}))}var I=n(427286);const x=e=>{if(e){const t=e.match(/\S+/g);if(t)return t.length}return 0},M=e=>{const t={rawLength:JSON.stringify(e).length,textLength:0,wordCount:0,imageCount:0,inlineMacroCount:0,macroCount:0,tableCount:0};return(0,I.u)(e,((e,t)=>{switch(t.type){case"text":return(0,s.Z)((0,s.Z)({},e),{},{textLength:e.textLength+(t.text?t.text.length:0),wordCount:e.wordCount+x(t.text)});case"media":return(0,s.Z)((0,s.Z)({},e),{},{imageCount:e.imageCount+1});case"inlineExtension":return(0,s.Z)((0,s.Z)({},e),{},{inlineMacroCount:e.macroCount+1});case"extension":return(0,s.Z)((0,s.Z)({},e),{},{macroCount:e.macroCount+1});case"table":return(0,s.Z)((0,s.Z)({},e),{},{tableCount:e.tableCount+1})}return e}),t)};var S=n(779076);const w=S.ZP`query ReadTimeQuery($contentId:ID){content(id:$contentId){nodes{id type body{dynamic{value representation}}}}}`,j=S.ZP`query ReadTimeSmartsQuery($id:ID!){getSmartContentFeature(contentId:$id){readTime}}`,R=e=>{var t;if("atlas_doc_format"===(null!=(t=e)&&null!=(t=t.content)&&null!=(t=t.nodes)&&null!=(t=t[0])&&null!=(t=t.body)&&null!=(t=t.dynamic)?t.representation:t)){var n;const t=null!=(n=e)&&null!=(n=n.content)&&null!=(n=n.nodes)&&null!=(n=n[0])&&null!=(n=n.body)&&null!=(n=n.dynamic)?n.value:n;if(t)try{return JSON.parse(t)}catch(a){return null}}return null},L=({contentId:e})=>{const{createAnalyticsEvent:t}=(0,o._)(),{data:n,loading:c,error:u}=(0,r.aM)(w,{variables:{contentId:e},fetchPolicy:"cache-only"});(0,a.useEffect)((()=>{var a;const r=R(n);if(!t||!r||c||u||!e)return;const o=null!=(a=n)&&null!=(a=a.content)&&null!=(a=a.nodes)&&null!=(a=a[0])?a.type:a;t({type:"sendOperationalEvent",data:{source:"confluence-frontend",action:"extracted",actionSubject:"contentFeature",objectType:o,objectId:e,attributes:M(r)}}).fire()}),[e,c,n,u,t]);const d=(0,a.useMemo)((()=>{const t=R(n);if(!t||c||u||!e)return null;const a=M(t);return $(a)}),[c,u,n,e]),s=(0,i.i0)().locale,m=s&&"en"===s.substring(0,2).toLowerCase();return d&&m?a.createElement(Z,{readTime:d,pageId:e}):u?a.createElement(l.X,{error:u}):null},F=({contentId:e})=>{var t;const n=(0,i.i0)().locale,o=n&&"en"===n.substring(0,2).toLowerCase(),{data:u,loading:s,error:m}=(0,r.aM)(j,{variables:{id:e},errorPolicy:"all",fetchPolicy:"cache-first"}),f=null==u||null===(t=u.getSmartContentFeature)||void 0===t?void 0:t.readTime;return s?null:null==f||!o||m?(0,c.j6)(m,"403")||null!=m&&m.message.includes("403")?((0,d.Xb)(m),null):a.createElement(a.Fragment,null,a.createElement(L,{contentId:e}),m&&a.createElement(l.X,{error:m})):a.createElement(Z,{readTime:f,pageId:e})};F.displayName="SmartsReadTime";const $=e=>Math.ceil((e.wordCount/265*60+(e=>{let t=0;for(let n=0;n<e;n++)t+=Math.max(12-n,3);return t})(e.imageCount))/60),_=({contentId:e})=>a.createElement(a.Fragment,null,a.createElement(u.q,{metric:h}),a.createElement(k,{contentId:e})),k=({contentId:e})=>a.createElement(F,{contentId:e});k.displayName="ReadTime"},427286:(e,t,n)=>{n.d(t,{u:()=>r});var a=n(710358);function r(e,t,n){let r=n;return(0,a.f)(e,{any:e=>{r=t(r,e)}}),r}},710358:(e,t,n)=>{n.d(t,{f:()=>r});var a=n(615919);function r(e,t){return o(e,{node:void 0},t,0,0)}function o(e,t,n,r,l){const c=n[e.type]||n.any;let i=(0,a.Z)({},e);if(c){const n=c((0,a.Z)({},i),t,r,l);if(!1===n)return!1;i=n||e}return i.content&&(i.content=i.content.reduce(((e,a,r)=>{if(!a)return e;const c=o(a,{node:i,parent:t},n,r,l+1);return!1!==c&&e.push(c),e}),[])),i}}}]);
//# sourceMappingURL=64591.58VGFasSlO.js.map