WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-context-v5', location = 'v5/js/context/util.js' */
define("ac/context/util",(function(){return{isValidExtensionOptionsForCache:function(t){var e=(!t.contextJwt||!connectHost.isJwtExpired(t.contextJwt,!0))&&!!t.structuredContext;if(e){var n=t.productContext&&Object.getOwnPropertyNames(t.productContext).length>0,o=Object.getOwnPropertyNames(t.structuredContext).length>0;!n||o||(e=!1)}return e}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-context-v5', location = 'v5/js/context/main.js' */
define("ac/context",["ac/content-resolver","ac/context/util"],(function(t,n){var e={};function o(t){if(t.id&&t.id.length>1)return t.id;throw new Error("ACJS: cannot generate cache key for extension")}function i(t){return e[t].context.contextObj}function c(t,n){return{cachedAt:Date.now(),contextJwt:n,contextObj:t}}function r(n){var i=o(n);if(!e[i]||!e[i].promise&&e[i].context&&3e4+e[i].context.cachedAt<Date.now()){n.classifier="json";e[i]=e[i]||{};e[i].promise=t.resolveByExtension(n,!0).done((function(t){t&&(e[i].context=c(t.options.structuredContext,t.options.contextJwt))}))}}function s(t){if(!t||t.length<2)throw new Error("ACJS: Cannot get token. Add-on does not support JWT authentication")}function x(t){if(n.isValidExtensionOptionsForCache(t.extension.options)){var i=o(t.extension);e[i]={context:c(t.extension.options.structuredContext,t.extension.options.contextJwt)}}else r(t.extension)}_AP.util.awaitGlobal("connectHost",(function(t){t.onIframeEstablished(x);t.onIframeUnload((function(t){delete e[o(t.extension)]}))}));var a={getToken:function(t){return new Promise((function(n,i){var c=o(t._context.extension);r(t._context.extension);if(e[c].promise)e[c].promise.done(function(t){s(t.options.contextJwt);try{n(t.options.contextJwt)}catch(t){}}.bind(this)).fail((function(){i("ACJS: content resolver failed to get context jwt token")})).always(function(){delete e[c].promise}.bind(this));else{s(e[c].context.contextJwt);n(e[c].context.contextJwt)}}))},getContext:function(t){return new Promise((function(n,c){var s=o(t._context.extension);t._context.extension.addon_key;r(t._context.extension);e[s].promise?e[s].promise.done(function(t){try{n(i(s))}catch(t){}}.bind(this)).fail((function(){c("ACJS: content resolver failed to get context")})).always(function(){delete e[s].promise}.bind(this)):n(i(s))}))}};a.getContext.returnsPromise=!0;a.getToken.returnsPromise=!0;return a}));
}catch(e){WRMCB(e)};