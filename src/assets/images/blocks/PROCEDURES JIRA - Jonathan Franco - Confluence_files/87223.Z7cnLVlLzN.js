"use strict";(self._cf=self._cf||[]).push([[87223,393],{115613:(e,t,n)=>{n.d(t,{q:()=>u});var o=n(840506),a=n(147760),r=n(54685),i=n(9019),d=n(740223),l=n(229230);const c=()=>{},s=(0,o.memo)((({metric:e,onComplete:t=c,timing:n=d.H.RENDER_BODY,isCustomStart:r=!1})=>{const i=(0,o.useCallback)((()=>{e&&(a.n.getPageLoadMetric().mark(`${l.w}:${e.key}`),r?e.start():e.startFromPageLoad(),t())}),[e,t,r]);return(0,d.G)(i,n),null})),u=(0,r.m)({attribution:i.x.BACKBONE})(s)},313304:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(697674),a=n(113059);const r=(0,o.is)({key:a.pk,timings:[{key:"fmp",endMark:"fmp"},{key:"tti",endMark:"tti"},{key:"pageCommentsRender",startMark:"pageCommentsRenderStart",endMark:"pageCommentsRenderEnd"}]})},429555:(e,t,n)=>{n.d(t,{x:()=>a});const o=()=>{},a=n(840506).createContext(o);a.displayName="EditContentButtonPreloaderContext"},498551:(e,t,n)=>{n.d(t,{A:()=>o});const o=(0,n(940155).y$)({__loadable_id__:"Zv3ON",name:"PageShownPublicLinksEventLoader",loader:async()=>{const{PageShownPublicLinksEvent:e}=await n.e(49105).then(n.bind(n,631946));return e}})},349044:(e,t,n)=>{n.d(t,{b:()=>o});let o=function(e){return e.COLLAB_EDIT_PROVIDER_FETCH="collabEditProviderAnalyticsFetch",e.COLLAB_EDIT_PROVIDER_CREATED="collabEditProviderCreated",e.COLLAB_EDIT_PROVIDER_DISABLED="collabEditProviderDisabled",e.COLLAB_EDIT_PROVIDER_INIT="collabEditProviderInitialized",e.COLLAB_EDIT_PROVIDER_PRE_CONNECTED="collabEditProviderPreconnected",e.COLLAB_EDIT_PROVIDER_CONNECTED="collabEditProviderConnected",e.COLLAB_EDIT_PROVIDER_INIT_DOC="collabEditProviderInitDoc",e.COLLAB_EDIT_PROVIDER_FETCH_NCS_DRAFT="collabEditProviderFetchNCSDraft",e.COLLAB_PERMS_TOKEN_FETCH="collabEditProviderPermsTokenFetch",e}({})},835892:(e,t,n)=>{n.d(t,{Ai:()=>r,FT:()=>i,_I:()=>a});var o=n(482995);const a=e=>0===(null==e?void 0:e.indexOf("CREATE_")),r=e=>a(e)||o.Jc.includes(e),i=e=>o.Jc.includes(e)},482995:(e,t,n)=>{n.d(t,{AD:()=>d,Ae:()=>s,Bp:()=>o,Dc:()=>a,Jc:()=>I,QI:()=>l,SR:()=>E,Yc:()=>r,Zy:()=>i,bl:()=>T,cZ:()=>v,s5:()=>c,sP:()=>_,ub:()=>m,y_:()=>u});const o="PAGE_EDIT_BUTTON_CLICK",a="BLOG_EDIT_BUTTON_CLICK",r="SPACE_EDIT_BUTTON_CLICK",i="PAGE_EDIT_SHORTCUT_E",d="BLOG_EDIT_SHORTCUT_E",l="SPACE_EDIT_SHORTCUT_E",c="NAVIGATION_RECENT_DROPDOWN_EDIT_BUTTON_CLICK",s="PAGECARD_EDIT_BUTTON_CLICK",u="QUICK_ACTIONS_EDIT_BUTTON_CLICK",E="CREATE_PAGE_SHORTCUT",m="CREATE_NAV_BUTTON_CLICK",_="CREATE_PAGETREE_BLOG_BUTTON_CLICK",T="CREATE_PAGETREE_CHILDPAGE_BUTTON_CLICK",v="CREATE_PAGETREE_PAGE_BUTTON_CLICK",I=[u,s,"PAGECARD_DRAFT_EDIT_BUTTON_CLICK",c]},629591:(e,t,n)=>{n.d(t,{I$:()=>d,tY:()=>i,xA:()=>r});var o=n(784569),a=n(169413);const r=async({contentId:e,createAnalyticsEvent:t})=>{const n=(0,o.WQ)(),r=performance.now(),i=await n.query({query:a.V,variables:{contentId:e},fetchPolicy:"cache-first",context:{single:"true"}});return t&&((e,{queryLoadTime:t,contentId:n})=>{e({type:"sendOperationalEvent",data:{action:"fetchEditorTypeAndVersionPropertyQuery",actionSubject:"nativeEditor",source:"confluenceFrontend",objectId:n,attributes:{queryLoadTime:t}}}).fire()})(t,{queryLoadTime:performance.now()-r,contentId:e}),null==i?void 0:i.data},i=e=>{var t;const n=null==e||null===(t=e.content)||void 0===t||null===(t=t.nodes)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.editor)||void 0===t||null===(t=t.nodes)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.value;return'"v2"'===n||"v2"===n},d=e=>{var t;return(null==e||null===(t=e.content)||void 0===t||null===(t=t.nodes)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.type)||null}},169413:(e,t,n)=>{n.d(t,{V:()=>o});const o=n(779076).ZP`query EditorTypeAndVersionPropertyQuery($contentId:ID){content(id:$contentId status:["current" "draft"]){nodes{id type editor:properties(key:"editor"){nodes{id value}}}}}`},300535:(e,t,n)=>{n.d(t,{L:()=>d});var o=n(615919),a=n(834232),r=n(944547);const i=(0,a.M)({initialState:(0,o.Z)({},{editSource:""}),actions:{setEditSource:e=>({setState:t})=>{t({editSource:e})}},name:"setEditSource"}),d=(0,r.Bi)(i)},92967:(e,t,n)=>{n.d(t,{l:()=>a});var o=n(199009);const a=new class{constructor(){(0,o.Z)(this,"tokenState",{})}getPermissionsTokenState(e){return this.tokenState[e]}setToken(e,t=Promise.resolve(null)){this.tokenState[e]={getToken:t,isUsedForDraftFetch:!1,isUsedForWSInitialization:!1}}setIsUsedForDraftFetch(e,t){this.tokenState[e]&&(this.tokenState[e].isUsedForDraftFetch=t)}setIsUsedForWSInitialization(e,t){this.tokenState[e]&&(this.tokenState[e].isUsedForWSInitialization=t)}setTimestamp(e){this.tokenState[e]&&(this.tokenState[e].timestamp=performance.now())}clearPermissionsTokenState(e){this.tokenState[e]&&delete this.tokenState[e]}}},650053:(e,t,n)=>{n.d(t,{$:()=>u});var o=n(615919),a=n(318122),r=n(784569),i=n(649233),d=n(349044),l=n(195988);const c=n(779076).ZP`query getCollabToken($contentId:ID!$draftShareId:String)@SLA{collabToken(id:$contentId draftShareId:$draftShareId){token}}`;var s=n(92967);const u=(0,a.default)(((e,t)=>async()=>{const n=s.l.getPermissionsTokenState(e);if(n){const{getToken:t,isUsedForDraftFetch:o,isUsedForWSInitialization:a}=n;if(o&&!a){const n=await t;if(n)return s.l.setIsUsedForWSInitialization(e,!0),n}}const a=(0,r.WQ)();try{var u,E;l.u.markMeasureStart(d.b.COLLAB_PERMS_TOKEN_FETCH);const n=await a.query({query:c,variables:(0,o.Z)({contentId:e},t&&{draftShareId:t}),fetchPolicy:"network-only"});return l.u.markMeasureEnd(d.b.COLLAB_PERMS_TOKEN_FETCH),null!==(u=null===(E=n.data)||void 0===E||null===(E=E.collabToken)||void 0===E?void 0:E.token)&&void 0!==u?u:null}catch(v){var m;if((0,i.Xb)(v),(_=v)&&"graphQLErrors"in _&&(null===(T=_.graphQLErrors)||void 0===T?void 0:T.some((e=>e.message.includes("Invalid content id")))))throw{message:"Content not found",data:{status:404,code:"INSUFFICIENT_EDITING_PERMISSION",meta:{description:"RESOURCE_DELETED",reason:"RESOURCE_DELETED"}}};if(503===(null==v||null===(m=v.networkError)||void 0===m||null===(m=m.response)||void 0===m?void 0:m.status))throw{message:"Service unavailable",data:{meta:{reason:"RESOURCE_DELETED"}}};return null}var _,T}))},637171:(e,t,n)=>{n.d(t,{iR:()=>s});var o=n(654927),a=n.n(o),r=n(179640);const i="confluence.frontend.auto.reload.page.comments",d="auto-reload_page_comments",l="control",c="variation",s=()=>!!(0,r.T)(i)&&a().getExperimentValue(d,"cohort",l)===c},825274:(e,t,n)=>{n.d(t,{j:()=>d,Y:()=>i});var o=n(840506),a=n(940155);const r=()=>o.createElement("div",{style:{height:"40px",display:"flex",width:"100%",padding:"var(--ds-space-100, 8px) var(--ds-space-250, 20px)",alignItems:"center",boxSizing:"border-box"}},o.createElement("div",{style:{height:"17px",width:"100%",backgroundColor:"var(--ds-background-neutral, #F8F8F8)",borderRadius:"10%"}}));r.displayName="PresentationModePlaceholder";const i=(0,a.tM)({__loadable_id__:"b_wkl",name:"PresenterModeContextProvider",loader:async()=>(await Promise.all([n.e(12705),n.e(61769),n.e(31382),n.e(42434),n.e(1244),n.e(72178),n.e(70289),n.e(83785),n.e(41123),n.e(38727)]).then(n.bind(n,163732))).PresenterModeContextProvider}),d=(0,a.ui)({__loadable_id__:"CCOHX",name:"LazyPresenterModeContextConsumer",loader:async()=>(await Promise.all([n.e(12705),n.e(61769),n.e(31382),n.e(42434),n.e(1244),n.e(72178),n.e(70289),n.e(83785),n.e(41123),n.e(38727)]).then(n.bind(n,163732))).PresenterModeContextConsumer,loading:()=>o.createElement(r,null)})},959948:(e,t,n)=>{n.d(t,{TB:()=>r,Uv:()=>i,V3:()=>a});var o=n(940155);const a=(0,o.tM)({__loadable_id__:"y64F6",name:"ViewPageLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(54936),n.e(11216),n.e(61769),n.e(14248),n.e(21488),n.e(84185),n.e(32072),n.e(35824),n.e(33963),n.e(31382),n.e(42434),n.e(1244),n.e(90077),n.e(72178),n.e(16215),n.e(39159),n.e(82995),n.e(48708),n.e(70289),n.e(87828),n.e(31462),n.e(75119),n.e(67616),n.e(33446),n.e(54305),n.e(16314),n.e(42505),n.e(52044),n.e(96400),n.e(84266),n.e(95470),n.e(71852),n.e(63681),n.e(61198),n.e(83785),n.e(61730),n.e(15682),n.e(51368),n.e(70483),n.e(96557),n.e(79472),n.e(7881),n.e(19196),n.e(35657)]).then(n.bind(n,572936))).ViewPage,_mustPreloadWhenRenderingSPA:["ViewPageRoute","ViewPageRouteComponent","ViewOrEditRoute"]}),r=(0,o.tM)({__loadable_id__:"5rAWO",name:"ViewPageLiteHeaderLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(11216),n.e(88085)]).then(n.bind(n,139527))).ViewPageLiteHeader}),i=(0,o.tM)({__loadable_id__:"TMMb7",name:"ViewPageLiteLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(54936),n.e(61769),n.e(83785),n.e(70483),n.e(96557),n.e(41123),n.e(13770),n.e(4793)]).then(n.bind(n,153696))).ViewPageLite,_mustPreloadWhenRenderingSPA:["ViewPageLiteRoute"]})},31885:(e,t,n)=>{n.d(t,{D:()=>o});const o=(0,n(940155).ZR)({__loadable_id__:"0BVX5",name:"TinyEditPageDataLoaderLoader",loader:()=>Promise.all([n.e(11216),n.e(61769),n.e(93734),n.e(99096),n.e(83396),n.e(21217)]).then(n.bind(n,558176))})},468395:(e,t,n)=>{n.r(t),n.d(t,{getEditorPreloader:()=>p});var o=n(615919),a=n(840506),r=n(167347),i=n(486889),d=n(169413),l=n(629591),c=n(582463),s=n(650053),u=n(92967);const E=({contentId:e,spaceKey:t,contentType:n})=>{const{userId:o,cloudId:r}=(0,c.D)(),{createAnalyticsEvent:d}=(0,i._)();return(0,a.useEffect)((()=>{(async()=>{u.l.setToken(e,(async()=>{try{const t=await(0,s.$)(e,"")();if(t)return u.l.setTimestamp(e),t}catch(t){d({type:"sendOperationalEvent",data:{actionSubject:"NCS preloading",action:"error preloading perms token on hover",source:"NativeEditPageDataLoader",attributes:{contentId:e,err:t}}}).fire()}return null})())})()}),[e,r,n,t,o,d]),null};var m=n(835892),_=n(300535),T=n(267083),v=n(31885);const I=({contentId:e,spaceKey:t,isEmbeddedEditor:o})=>{const c=performance.now(),{createAnalyticsEvent:s}=(0,i._)(),[{editSource:u}]=(0,_.L)(),I=(0,m._I)(u),p=(0,m.Ai)(u),C=o||I||!e,{data:b,loading:P,error:y}=(0,r.aM)(d.V,{variables:{contentId:e},skip:C}),g=C||!P;let S=!0,R=null;C||P||(S=!!y||(0,l.tY)(b),R=y?R:(0,l.I$)(b));const f=()=>{s({type:"sendOperationalEvent",data:{actionSubject:"editor",action:"preloader.timing",source:"editorPreloader",attributes:{timing:performance.now()-c,collabService:"ncs",isFabricEditor:S,contentId:e}}}).fire()};return(0,a.useEffect)((()=>{n.e(63152).then(n.bind(n,796451)).then((({getPubSubClient:e})=>e())),g&&(S?(0,T.nativeEditorComponentsPreloader)().then((()=>{f()})):(0,T.tinyEditorComponentsPreloader)().then((()=>{f()})))}),[b,S]),I||!e||p?null:g&&!S?a.createElement(v.D,{contentId:e,contentType:R}):g?a.createElement(E,{contentId:e,spaceKey:t,contentType:R}):null},p=()=>e=>a.createElement(I,(0,o.Z)({},e))},403847:(e,t,n)=>{n.d(t,{u:()=>v});var o=n(615919),a=n(547357),r=n(178825),i=n(840506),d=n(973352),l=n(115613),c=n(745869),s=n(940155),u=n(179640),E=n(173729),m=n(313304),_=n(637171);const T=(0,s.ui)({__loadable_id__:"OSfNc",name:"CommentsSectionFabric",loading:({handlePageCommentsRender:e})=>e?null:i.createElement(E.X,null),loader:()=>Promise.all([n.e(12705),n.e(54936),n.e(61769),n.e(29583),n.e(25677),n.e(61730),n.e(89946),n.e(27456)]).then(n.bind(n,519696))}),v=e=>{let t=(0,r.Z)({},((0,a.Z)(e),e));const n=(0,u.T)("confluence.frontend.collaborative.page.comments"),s=(0,u.T)("confluence.frontend.powered.by.confluence.mobile"),E=(0,_.iR)(),{sideNavLearningLoopCohort:v}=(0,d.LO)();return i.createElement(i.Fragment,null,i.createElement(l.q,{key:t.contentId,metric:m.E,isCustomStart:!0}),i.createElement(c.T,{markName:"pageCommentsRenderStart",metric:m.E}),i.createElement(T,(0,o.Z)((0,o.Z)({},t),{},{isCollaborativePageCommentsEnabled:n,isPoweredByConfluenceMobileEnabled:s,sideNavLearningLoopCohort:v,isAutoReloadPageCommentsEnabled:E})))};v.displayName="CommentsSectionLoader"},26575:(e,t,n)=>{n.r(t),n.d(t,{ViewPageRouteComponent:()=>p});var o=n(840506),a=n(468395),r=n(429555),i=n(338707),d=n(234461),l=n(9019),c=n(959948),s=n(498551),u=n(825274),E=n(707456),m=n(665090),_=n(403847),T=n(619968),v=n(562193),I=n(374922);const p=({spaceKey:e,contentId:t,contentSlug:n,isPage:p,isMobile:C,isEmbeddedConfluence:b})=>{const P=p?"page":"blogpost";let y;return y=b?o.createElement(I.W,null,o.createElement(i.F2,{contentId:t,spaceKey:e,classicComments:_.u})):C?o.createElement(I.W,null,o.createElement(v.Cx,null)):o.createElement(I.W,null,o.createElement(r.x.Provider,{value:(0,a.getEditorPreloader)()},o.createElement(u.Y,{contentId:t,spaceKey:e},o.createElement(c.V3,{spaceKey:e,contentId:t,contentSlug:"page"===P?n:void 0,classicComments:_.u},o.createElement(d.S,{attribution:l.x.BACKBONE},o.createElement(E.ZP,{pageType:P})))))),o.createElement(o.Fragment,null,o.createElement(T.Z,null,o.createElement(m.R,null,y)),o.createElement(v.ju,null),o.createElement(s.A,{contentId:t,pageType:P}))};p.displayName="ViewPageRouteComponent"},707456:(e,t,n)=>{n.d(t,{ZP:()=>I});var o=n(840506),a=n(911492),r=n(487696),i=n(329687),d=n.n(i),l=n(430564);function c(e){const{action:t,actionSubject:n,attributes:a,containerId:r,containerType:i,objectId:d,objectType:l,source:c}=e;return(0,o.useEffect)((()=>{(e=>{const{createAnalyticsEvent:t}=e;t({type:"sendTrackEvent",data:{action:e.action,actionSubject:e.actionSubject,attributes:e.attributes,containerId:e.containerId,containerType:e.containerType,objectId:e.objectId,objectType:e.objectType,source:e.source}}).fire()})(e)}),[t,n,a,r,i,d,l,c]),null}c.propTypes={action:d().string.isRequired,actionSubject:d().string.isRequired,attributes:d().object,containerId:d().string.isRequired,containerType:d().string.isRequired,objectId:d().string.isRequired,objectType:d().string.isRequired,source:d().string.isRequired,createAnalyticsEvent:d().func.isRequired},c.defaultProps={attributes:{}};const s=(0,l.Z)()(c);const u=n(779076).ZP`query SendTrackViewPageEventQuery($contentId:ID){content(id:$contentId){nodes{id history{createdDate lastUpdated{when}}metadata{frontend{fabricEditorSupported fabricEditorEligibility}}space{id}status}}}`,E=(e,t=new Date)=>{const n=new Date(e);return Math.round((t.getTime()-n.getTime())/864e5)},m=e=>{var t;const n=null==e||null===(t=e.history)||void 0===t?void 0:t.createdDate;return n?E(n):-1},_=e=>{var t;const n=null==e||null===(t=e.history)||void 0===t||null===(t=t.lastUpdated)||void 0===t?void 0:t.when;return n?E(n):-1},T=(e=new Date)=>{const t=e.getHours();return t>=15&&t<=23};function v({pageType:e,source:t}){return o.createElement(r.z1.Consumer,null,(({contentId:n,searchSessionId:r})=>o.createElement(a.AE,{query:u,variables:{contentId:n}},(({data:a,loading:i,error:d})=>{var l,c,u;if(d||i)return null;const E=null==a||null===(l=a.content)||void 0===l||null===(l=l.nodes)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.space,v=null==a||null===(c=a.content)||void 0===c||null===(c=c.nodes)||void 0===c||null===(c=c[0])||void 0===c||null===(c=c.metadata)||void 0===c||null===(c=c.frontend)||void 0===c?void 0:c.fabricEditorSupported,I=null==a||null===(u=a.content)||void 0===u||null===(u=u.nodes)||void 0===u||null===(u=u[0])||void 0===u||null===(u=u.metadata)||void 0===u||null===(u=u.frontend)||void 0===u?void 0:u.fabricEditorEligibility;return E?o.createElement(s,{action:"viewed",actionSubject:"page",source:t,containerType:"space",containerId:E.id,objectType:"page",objectId:n,attributes:{pageType:e,daysSinceCreated:m(a.content.nodes[0]),daysSinceModified:_(a.content.nodes[0]),searchReferrer:r,isArchivedPage:"archived"===a.content.nodes[0].status,viewedScreenAfter3PM:T(),fabricEditorEligibility:I,fabricEditorSupported:v}}):null}))))}v.displayName="SendTrackViewPageEvent",v.defaultProps={source:"viewPageScreen"};const I=v}}]);
//# sourceMappingURL=87223.Z7cnLVlLzN.js.map