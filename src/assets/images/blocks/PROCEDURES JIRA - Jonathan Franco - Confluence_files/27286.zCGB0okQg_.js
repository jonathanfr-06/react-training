"use strict";(self._cf=self._cf||[]).push([[27286],{565867:(t,i,e)=>{e.d(i,{S:()=>n});var s=e(779076),a=e(267182);const n=s.ZP`query GlobalOperationsUserPermissionTypeQuery{...UserPermissionFragment}${a.M}`},140576:(t,i,e)=>{e.d(i,{n:()=>s});let s=function(t){return t.ANONYMOUS="ANONYMOUS",t.APP="APP",t.EXTERNAL="EXTERNAL",t.INTERNAL="INTERNAL",t.JSD="JSD",t}({})},611246:(t,i,e)=>{e.d(i,{KN:()=>a,W4:()=>o,d1:()=>r,pA:()=>s,xu:()=>n});const s="confluence.frontend.enable.external.collab",a="confluence.frontend.enable.external.collab.single.space",n="confluence.frontend.external-collaboration.guest-access.request-to-upgrade.experiment",r="confluence.frontend.external-collaboration.guest-access.request-to-upgrade.no-space-access-page",o="https://support.atlassian.com/confluence-cloud/docs/what-can-guests-see-and-do-on-confluence/"},815037:(t,i,e)=>{e.d(i,{Q:()=>h});var s=e(167347),a=e(179640),n=e(565867),r=e(140576),o=e(611246),d=e(980452);let l;const h=(t=!1)=>{const i=(0,a.T)(o.pA),{data:e,loading:h,error:c}=(0,s.aM)(n.S,{errorPolicy:"all",skip:!i||void 0!==l||t,onCompleted(t){l=l||(0,d.F)(t)===r.n.EXTERNAL}});return{isExternalCollaborator:l||(0,d.F)(e)===r.n.EXTERNAL,loading:h,error:c}}},688763:(t,i,e)=>{e.d(i,{t:()=>a});var s=e(815037);const a=()=>{const{isExternalCollaborator:t,loading:i,error:e}=(0,s.Q)();return{canViewUserProfile:!t,loading:i,error:e}}},270718:(t,i,e)=>{e.d(i,{h:()=>s});const s={NOT_STARTED:{id:"NOT_STARTED",final:!0},STARTED:{id:"STARTED"},IN_PROGRESS:{id:"IN_PROGRESS"},BLOCKED:{id:"BLOCKED"},RECOVERED:{id:"RECOVERED"},SUCCEEDED:{id:"SUCCEEDED",final:!0,success:!0},SUCCEEDED_WAITING_FOR_DEPS:{id:"SUCCEEDED_WAITING_FOR_DEPS"},FAILED:{id:"FAILED",final:!0},ABORTED:{id:"ABORTED",final:!0}}},747298:(t,i,e)=>{e.d(i,{Q:()=>S});var s=e(615919),a=e(199009),n=e(278811);var r=e(824953),o=e(450466),d=e(118407),l=e(853576),h=e(52431);var c=e(270718);const u={[c.h.NOT_STARTED.id]:[c.h.STARTED.id],[c.h.STARTED.id]:[c.h.IN_PROGRESS.id,c.h.BLOCKED.id,c.h.SUCCEEDED.id,c.h.SUCCEEDED_WAITING_FOR_DEPS.id,c.h.FAILED.id,c.h.ABORTED.id],[c.h.IN_PROGRESS.id]:[c.h.BLOCKED.id,c.h.SUCCEEDED.id,c.h.SUCCEEDED_WAITING_FOR_DEPS.id,c.h.FAILED.id,c.h.ABORTED.id],[c.h.BLOCKED.id]:[c.h.RECOVERED.id,c.h.ABORTED.id],[c.h.RECOVERED.id]:[c.h.STARTED.id,c.h.SUCCEEDED.id,c.h.SUCCEEDED_WAITING_FOR_DEPS.id,c.h.FAILED.id,c.h.ABORTED.id],[c.h.SUCCEEDED.id]:[c.h.STARTED.id],[c.h.SUCCEEDED_WAITING_FOR_DEPS.id]:[c.h.SUCCEEDED.id,c.h.FAILED.id,c.h.ABORTED.id],[c.h.FAILED.id]:[c.h.STARTED.id],[c.h.ABORTED.id]:[c.h.STARTED.id]};var E=e(288920);const m=()=>(0,r.d)()&&window.document&&"visible"!==window.document.visibilityState?h.Qx.HIDDEN:h.Qx.VISIBLE,T=t=>void 0!==t?~~t:~~performance.now();class p{constructor(t,i,e=null){(0,a.Z)(this,"state",c.h.NOT_STARTED),(0,a.Z)(this,"id",void 0),(0,a.Z)(this,"instanceId",null),(0,a.Z)(this,"parent",null),(0,a.Z)(this,"category",null),(0,a.Z)(this,"type",void 0),(0,a.Z)(this,"performanceType",void 0),(0,a.Z)(this,"metadata",{}),(0,a.Z)(this,"onDoneCallbacks",[]),(0,a.Z)(this,"childExperiences",[]),(0,a.Z)(this,"featureFlags",void 0),(0,a.Z)(this,"timings",void 0),(0,a.Z)(this,"explicitTimings",{}),(0,a.Z)(this,"isSSROutputAsFMP",!1),(0,a.Z)(this,"handleDoneBind",void 0),(0,a.Z)(this,"uuid",null),(0,a.Z)(this,"until",void 0),(0,a.Z)(this,"_until",null),(0,a.Z)(this,"pageVisibleState",void 0),(0,a.Z)(this,"metrics",{startTime:null,endTime:null,marks:[]}),(0,a.Z)(this,"performanceConfig",{}),(0,a.Z)(this,"config",void 0),(0,a.Z)(this,"setPageVisibleStateToMixed",(()=>{this.pageVisibleState=h.Qx.MIXED,l.m.unsubscribe(this.setPageVisibleStateToMixed)})),this.id=t,this.category=(null==i?void 0:i.category)||null,this.until=(null==i?void 0:i.until)||null,this.instanceId=e,this.handleDoneBind=this._handleDoneExperience.bind(this),this.type=i.type,this.performanceType=i.performanceType,this.performanceConfig=i.performanceConfig||{},this.config=i,this.pageVisibleState=m(),this.featureFlags=i.featureFlags||[],this.timings=i.timings||[],i.performanceType!==E.R.PageLoad&&i.performanceType!==E.R.PageSegmentLoad||(this.isSSROutputAsFMP=i.isSSROutputAsFMP||!1)}async transition(t,i){if((0,d.Hw)("async transition",this.id,this.state.id,t.id),e=this.state,s=t,u[e.id]&&u[e.id].includes(s.id)){if((0,d.Hw)(`TRANSITION: ${this.id} from ${this.state.id} to ${t.id} successful`,this.state.final,!t.final),t===c.h.STARTED&&this._reset(),this.state.final&&!t.final&&(this.metrics.startTime=T(i),this.uuid=(0,n.v4)()),this.state=t,t.final){this.metrics.endTime=T(i),this._isManualStateEnabled()||(0,o.ur)().push((0,o.US)(h.lS,this.handleDoneBind));const t=await this.exportData();(0,d.Hw)("this.parent",this.parent),(0,o.ur)().push((0,o.sG)(t))}return!0}var e,s;return(0,d.Hw)(`TRANSITION: ${this.id} from ${this.state.id} to ${t.id} unsuccessful`),(0,d.hl)(`transition of ${this.id} from ${this.state} to ${t} is not possible`),!1}async start(t){await this.transition(c.h.STARTED,t)&&(this.pageVisibleState=m(),l.m.subscribe(this.setPageVisibleStateToMixed),this._isManualStateEnabled()||((0,d.Hw)("subscribed",this.id),(0,o.ur)().push((0,o.o5)(h.lS,this.handleDoneBind))))}mark(t,i){t!==h.WR&&t!==h.j3?this._mark(t,i):(0,d.hl)("please use markFMP or markInlineResponse for specialised marks")}_mark(t,i){this.metrics.marks.push({name:t,time:T(i)}),this.transition(c.h.IN_PROGRESS)}markFMP(t){this._mark(h.WR,t)}markInlineResponse(t){this._mark(h.j3,t)}_isManualStateEnabled(){return null===this.until}_validateManualState(){return!!this._isManualStateEnabled()||((0,d.hl)('manual change of state not allowed as "until" is defined'),!1)}switchToEndState(t,i){return null!=i&&i.force||this._validateManualState()?(null!=i&&i.metadata&&this.addMetadata(i.metadata),l.m.unsubscribe(this.setPageVisibleStateToMixed),this.transition(t)):null}async success(t){return this.switchToEndState(c.h.SUCCEEDED,t)}async failure(t){return this.switchToEndState(c.h.FAILED,t)}async abort(t){return this.switchToEndState(c.h.ABORTED,t)}addMetadata(t){Object.assign(this.metadata,t)}_handleDoneExperience(t){if((0,d.Hw)("_handleDoneExperience in",this.id,t.state,t,this._until),t.state.final&&null!==this._until){const{done:i,state:e}=this._until(t);i&&!this.state.final&&this.transition(e)}}async getId(){return this.id}async exportData(){return{id:await this.getId(),uuid:this.uuid,type:this.type,schemaVersion:"0.1.5",performanceType:this.performanceType,category:this.category,state:this.state,metadata:(0,s.Z)({},this.metadata),metrics:(0,s.Z)({},this.metrics),children:[...this.childExperiences],result:{success:!!this.state.success,startTime:this.metrics.startTime,duration:(this.metrics.endTime||0)-(this.metrics.startTime||0)},platform:this.config.platform||null,pageVisibleState:this.pageVisibleState,featureFlags:this.featureFlags,isSSROutputAsFMP:this.isSSROutputAsFMP,timings:this.timings,explicitTimings:this.explicitTimings,performanceConfig:this.performanceConfig}}_reset(){this.parent=null,this.metadata={},this.onDoneCallbacks=[],this.childExperiences=[],this.metrics={startTime:null,endTime:null,marks:[]},this._until=this.until?this.until():null}}class S extends p{}},726054:(t,i,e)=>{e.d(i,{P:()=>n});var s=e(199009);class a{constructor(){(0,s.Z)(this,"aborted",!1),(0,s.Z)(this,"reason",""),(0,s.Z)(this,"onabort",(()=>{})),(0,s.Z)(this,"throwIfAborted",(()=>{})),(0,s.Z)(this,"addEventListener",(()=>{})),(0,s.Z)(this,"removeEventListener",(()=>{})),(0,s.Z)(this,"dispatchEvent",(()=>!1))}}class n{abort(){}constructor(){if((0,s.Z)(this,"signal",new a),"object"==typeof window&&window.AbortController){const t=new AbortController;this.abort=t.abort.bind(t),this.signal=t.signal}}}},920885:(t,i,e)=>{e.d(i,{G:()=>r,V:()=>o});var s=e(615919),a=e(840506),n=e(853463);const r=(...[t,i,e])=>{const[r,o]=(0,a.useState)((0,s.Z)({loading:!1,error:void 0,data:void 0},null==e?void 0:e.initialState)),d=(0,a.useCallback)((async()=>{o((t=>(0,s.Z)((0,s.Z)({},t),{},{loading:!0})));try{var i;const r=await t(),d=null==r||null===(i=r.headers)||void 0===i?void 0:i.get("atl-traceid");let l,h=!1;const c=await(null==r?void 0:r.text())||"{}";try{l=JSON.parse(c)}catch(a){h=!0}if(null==r||!r.ok||h)throw null!=e&&e.ErrorHandler?new e.ErrorHandler((0,s.Z)((0,s.Z)({},l),{},{traceId:d,status:null==r?void 0:r.status,statusText:(null==r?void 0:r.statusText)||c})):new n.oo(null==r?void 0:r.status,(null==r?void 0:r.statusText)||c,d);return o((t=>(0,s.Z)((0,s.Z)({},t),{},{loading:!1,data:l}))),r}catch(r){o((t=>(0,s.Z)((0,s.Z)({},t),{},{loading:!1,error:r})))}}),[t,null==e?void 0:e.ErrorHandler]);return(0,a.useEffect)((()=>()=>{i.abort()}),[i]),[d,r]},o=(...[t,i,e])=>{const[n,o]=r(t,i,(0,s.Z)((0,s.Z)({},e),{},{initialState:(0,s.Z)((0,s.Z)({},null==e?void 0:e.initialState),{},{loading:!0})}));return(0,a.useEffect)((()=>{n()}),[n]),o}},853463:(t,i,e)=>{e.d(i,{oo:()=>d,zm:()=>o});var s=e(199009),a=e(615919),n=e(726054);const r=(t,i={})=>()=>fetch(t,(0,a.Z)({method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}},i)),o=(t,i={})=>{const e=new n.P;return[r(t,(0,a.Z)({signal:e.signal},i)),e]};class d extends Error{constructor(t,i,e){super(i),(0,s.Z)(this,"code",void 0),(0,s.Z)(this,"traceId",void 0),this.code=t,this.traceId=e}}},264683:(t,i,e)=>{e.d(i,{O:()=>D});var s=e(615919),a=e(840506),n=e(834232),r=e(944547),o=e(199009);class d extends Error{constructor(t,...i){super(...i),(0,o.Z)(this,"message",void 0),(0,o.Z)(this,"status",void 0),(0,o.Z)(this,"path",void 0),(0,o.Z)(this,"timestamp",void 0),this.name="LegionError",this.message=t.error,this.status=t.status,this.path=t.path,this.timestamp=t.timestamp}}var l=e(920885),h=e(872342),c=e(726054),u=e(853463);let E=function(t){return t.canCreateTeams="CAN_CREATE_TEAMS",t.canViewTeams="CAN_VIEW_TEAMS",t.canAdminTeams="CAN_ADMIN_TEAMS",t}({});const m=["orgId"],T=t=>t.reduce(((t,i)=>{switch(i){case E.canCreateTeams:return(0,s.Z)((0,s.Z)({},t),{},{canCreateTeams:!0});case E.canViewTeams:return(0,s.Z)((0,s.Z)({},t),{},{canViewTeams:!0});case E.canAdminTeams:return(0,s.Z)((0,s.Z)({},t),{},{canAdminTeams:!0});default:return t}}),{canCreateTeams:!1,canViewTeams:!1,canAdminTeams:!1}),p=(0,n.M)({initialState:{error:void 0,hasLoaded:!1,isLoading:!1,permissions:{canCreateTeams:!0,canViewTeams:!0,canAdminTeams:!1}},actions:{setError:t=>({setState:i})=>{i({hasLoaded:!0,isLoading:!1,error:t})},setLoading:t=>({setState:i})=>{i({isLoading:t})},setPermissions:t=>({setState:i})=>{i({hasLoaded:!0,isLoading:!1,permissions:T(t)})}},name:"teams-permissions"}),S=(0,r.Bi)(p),D=(t,{enabled:i,initialState:e}={enabled:!1,initialState:{}})=>{const{orgId:n,cloudId:r}="string"!=typeof t&&t?t:{orgId:t,cloudId:void 0},[o,{setError:E,setLoading:T,setPermissions:p}]=S(),[D,g]=(0,a.useMemo)((()=>(t=>{let{orgId:i}=t,e=(0,h.Z)(t,m);return i?(0,u.zm)((({orgId:t,siteId:i,apiVersion:e})=>`/gateway/api/${e}/teams/permission/self/organization/${t}${"v4"===e?`?siteId=${i}`:""}`)((0,s.Z)((0,s.Z)({},e),{},{orgId:i})),{method:"GET"}):[()=>Promise.resolve(),new c.P]})({orgId:n,apiVersion:"v4",siteId:null!=r?r:"None"})),[n,r]),[f,{loading:A,error:R,data:Z}]=(0,l.G)(D,g,{ErrorHandler:d,initialState:e}),C=o.isLoading&&!A,v=o.error||o.hasLoaded,I=n&&i&&!v&&!C;return(0,a.useEffect)((()=>((async()=>{I&&(T(!0),await f())})(),()=>{T(!1)})),[f,T,I]),(0,a.useEffect)((()=>{null!=Z&&Z.permissions&&p(Z.permissions),R&&E(R)}),[Z,R,p,E]),(0,s.Z)({loading:A,data:Z},o)}}}]);
//# sourceMappingURL=27286.zCGB0okQg_.js.map